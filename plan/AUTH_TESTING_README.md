# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ TrenerFront

## üéØ –¶–µ–ª—å

–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏.

## ‚úÖ –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è

- ‚ùå **–û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** (`user`) –ù–ï –≤–∏–¥—è—Ç –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- ‚úÖ **–ê–¥–º–∏–Ω—ã** (`admin`) –≤–∏–¥—è—Ç –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- ‚úÖ **–°—É–ø–µ—Ä –∞–¥–º–∏–Ω—ã** (`superadmin`) –≤–∏–¥—è—Ç –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- ‚úÖ **korobprog@gmail.com** –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏—è–º

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
node run-auth-tests.js

# –¢–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã
node run-auth-tests.js --basic

# –¢–æ–ª—å–∫–æ HTTP —Ç–µ—Å—Ç—ã
node run-auth-tests.js --http
```

## üìÅ –§–∞–π–ª—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

| –§–∞–π–ª                                                         | –û–ø–∏—Å–∞–Ω–∏–µ                                |
| ------------------------------------------------------------ | --------------------------------------- |
| [`run-auth-tests.js`](./run-auth-tests.js)                   | üéÆ –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç - –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã |
| [`test-auth-fixes.js`](./test-auth-fixes.js)                 | üîß –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã middleware –∏ —Ä–æ–ª–µ–π    |
| [`test-auth-api-requests.js`](./test-auth-api-requests.js)   | üåê HTTP —Ç–µ—Å—Ç—ã API endpoints             |
| [`docs/auth-testing-guide.md`](./docs/auth-testing-guide.md) | üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è               |

## üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### Middleware

- [`lib/middleware/adminAuth.js`](./lib/middleware/adminAuth.js) - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∞
- [`lib/middleware/superAdminAuth.js`](./lib/middleware/superAdminAuth.js) - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∞

### API Endpoints

- `/api/admin/statistics` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- `/api/admin/users` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `/api/admin/logs` - –õ–æ–≥–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `/api/admin/interviews` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è–º–∏

## üìä –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```
=== –û–¢–ß–ï–¢ –û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ò –°–ò–°–¢–ï–ú–´ –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò ===

–û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:
  –í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: 24
  –ü—Ä–æ–π–¥–µ–Ω–æ: 24
  –ü—Ä–æ–≤–∞–ª–µ–Ω–æ: 0
  –£—Å–ø–µ—à–Ω–æ—Å—Ç—å: 100%

‚úÖ user –ù–ï –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω API
‚úÖ admin –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω API
‚úÖ superadmin –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω API
‚úÖ korobprog@gmail.com –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫–∞–∫ superadmin
```

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install @prisma/client bcryptjs

# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
DATABASE_URL="postgresql://..."
NEXTAUTH_URL="http://localhost:3000"
```

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 'user' –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω API

```javascript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å lib/middleware/adminAuth.js
if (user.role !== 'admin' && user.role !== 'superadmin') {
  return res.status(403).json({ message: '–¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞' });
}
```

### korobprog@gmail.com –Ω–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞

```sql
-- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∞
UPDATE "User" SET role = 'superadmin' WHERE email = 'korobprog@gmail.com';
```

### HTTP —Ç–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
curl http://localhost:3000/api/health
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –¥–∞—Ç–æ–π
node run-auth-tests.js > auth-test-$(date +%Y%m%d).log 2>&1

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (crontab)
0 2 * * * cd /path/to/project && node run-auth-tests.js
```

## üé® –¶–≤–µ—Ç–æ–≤–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞

- üü¢ **–ó–µ–ª–µ–Ω—ã–π** - –¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω —É—Å–ø–µ—à–Ω–æ
- üî¥ **–ö—Ä–∞—Å–Ω—ã–π** - –¢–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω, —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è
- üü° **–ñ–µ–ª—Ç—ã–π** - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∏–ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è
- üîµ **–°–∏–Ω–∏–π** - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [–ø–æ–¥—Ä–æ–±–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é](./docs/auth-testing-guide.md)
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

---

**–°–æ–∑–¥–∞–Ω–æ:** 31.05.2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

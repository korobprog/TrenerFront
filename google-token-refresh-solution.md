# –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Google —Ç–æ–∫–µ–Ω–æ–≤

## ‚úÖ –ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

–î–µ—Ä–∂–∞—Ç—å –≤ –±–∞–∑–µ:

- ‚úÖ GOOGLE_REFRESH_TOKEN ‚Äî –Ω—É–∂–µ–Ω –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (userId, email –∏ —Ç.–¥.)
- ‚úÖ –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è access_token

## –ö–∞–∫ —á–∞—Å—Ç–æ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å GOOGLE_REFRESH_TOKEN?

üü¢ –û—Ç–≤–µ—Ç: –æ–±—ã—á–Ω–æ –Ω–∏–∫–æ–≥–¥–∞ (–∏–ª–∏ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:

- GOOGLE_REFRESH_TOKEN –≤—ã–¥–∞—ë—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º access_type=offline.
- –û–Ω –Ω–µ –∏—Å—Ç–µ–∫–∞–µ—Ç (–ø–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –æ—Ç–∑–æ–≤—ë—Ç –¥–æ—Å—Ç—É–ø –∏–ª–∏ –ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤).
- –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ OAuth2, —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ refresh_token –¥–ª—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤—ã—Ö access_token.
- ‚ùó –ï—Å–ª–∏ —Ç—ã –≤–∏–¥–∏—à—å, —á—Ç–æ –æ–Ω –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –º–µ–Ω—è–µ—Ç—Å—è, –∑–Ω–∞—á–∏—Ç —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫ —Å —Ç–≤–æ–∏–º OAuth2-–ø–æ—Ç–æ–∫–æ–º ‚Äî —Ç—ã, –≤–µ—Ä–æ—è—Ç–Ω–æ, –ø–æ–≤—Ç–æ—Ä–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑—É–µ—à—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç–∞—Ä–æ–≥–æ refresh_token.

## üîÅ –ü—Ä–æ–±–ª–µ–º—ã, –µ—Å–ª–∏ refresh_token —á–∞—Å—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è –∏ –ø–∏—à–µ—Ç—Å—è –≤ .env.local / .env.production

### ‚ùå 1. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ dev-—Å–µ—Ä–≤–µ—Ä–∞ –∏ –ø—Ä–æ–¥-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ .env.local –≤ dev ‚Äî Next.js –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä.
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ .env.production –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ ‚Äî —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–µ–ø–ª–æ–π / restart, –∏–Ω–∞—á–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —É–≤–∏–¥–∏—Ç –Ω–æ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é.

### ‚ùå 2. –ü–æ—Ç–µ—Ä—è —Å–æ—Å—Ç–æ—è–Ω–∏—è, –º–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

- –ö–∞–∂–¥—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Å–µ—Å—Å–∏–∏, WebSocket-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –∫—ç—à –∏ —Ç.–¥.
- –≠—Ç–æ –º–µ—à–∞–µ—Ç —Ä–∞–±–æ—Ç–µ –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (—á–∞—Ç, –¥–æ—Å–∫–∞, –≤–∏–¥–µ–æ –∏ —Ç.–¥.).

### ‚ùå 3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

- –•—Ä–∞–Ω–µ–Ω–∏–µ refresh_token –≤ .env:
  - –£—è–∑–≤–∏–º–æ, –µ—Å–ª–∏ .env –ø–æ–ø–∞–¥—ë—Ç –≤ git/CI/CD.
  - –ù–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## ‚úÖ –ö–∞–∫ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É—Å—Ç—Ä–æ–µ–Ω–æ

### 1. –û–¥–∏–Ω refresh_token –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–∞–∑–µ:

```json
{
  "user_id": "123",
  "refresh_token": "1//0abcdef...",
  "created_at": "2025-05-18T12:00:00Z"
}
```

### 2. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî –ø–æ–ª—É—á–∞–µ—à—å –Ω–æ–≤—ã–π access_token —Ç–∞–∫:

```javascript
oauth2Client.setCredentials({ refresh_token: user.refresh_token });
const { token } = await oauth2Client.getAccessToken();
```

## üö´ –ö–æ–≥–¥–∞ refresh_token –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Å—Ç–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–æ–∑–≤–∞–ª –¥–æ—Å—Ç—É–ø (–≤ Google Account ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Üí –î–æ—Å—Ç—É–ø –∫ –∞–∫–∫–∞—É–Ω—Ç—É).
- –£ —Ç–µ–±—è —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –æ–¥–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: Google —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ 10 refresh_tokens –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-–∫–ª–∏–µ–Ω—Ç.
- –¢—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å access_type=offline –∏ prompt=consent –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ ‚Äî —Ç–æ–≥–¥–∞ Google –º–æ–∂–µ—Ç –Ω–µ –≤–µ—Ä–Ω—É—Ç—å refresh_token –≤–æ–æ–±—â–µ.

## üß© –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

| –í–æ–ø—Ä–æ—Å                                          | –û—Ç–≤–µ—Ç                                                                                  |
| ----------------------------------------------- | -------------------------------------------------------------------------------------- |
| –ö–∞–∫ —á–∞—Å—Ç–æ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å GOOGLE_REFRESH_TOKEN? | –ü–æ—á—Ç–∏ –Ω–∏–∫–æ–≥–¥–∞ ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–æ–∑–≤–∞–ª –¥–æ—Å—Ç—É–ø     |
| –ù—É–∂–Ω–æ –ª–∏ –ø–∏—Å–∞—Ç—å –µ–≥–æ –≤ .env?                     | ‚ùå –ù–µ—Ç, –ª—É—á—à–µ —Ö—Ä–∞–Ω–∏—Ç—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ                        |
| –ü–æ—á–µ–º—É refresh_token –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è?            | –¢—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑ –≤—ã–∑—ã–≤–∞–µ—à—å OAuth –±–µ–∑ access_type=offline –∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—à—å –ø–µ—Ä–≤—ã–π —Ç–æ–∫–µ–Ω     |
| –ß—Ç–æ –¥–µ–ª–∞—Ç—å?                                     | –û–¥–∏–Ω —Ä–∞–∑ –ø–æ–ª—É—á–∏—Ç—å refresh_token, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –±–∞–∑–µ, –ø–æ—Ç–æ–º —Ç–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª—è—Ç—å access_token |
